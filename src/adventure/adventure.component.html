<mat-card class="stat-board">
    <div>{{player.userName}}</div>
    @for (playerStat of player.playerStats; track playerStat) {
        @if (!playerStat.statType.favorType) {
            <div>{{playerStat.statType.label}}: {{playerStat.value}}</div>
        }
    }
</mat-card><br>

@if(playerTurn && !isDone) {
    @if (storyRetrieved && locations.length > 0) {
        <br>
        <prequel-story-display 
            [gameCode]="gameCode" 
            [story]="playerStory"
            [isAdventureMode]="true">
        </prequel-story-display>
        <br>
        <mat-card class="story">
            <div #storyCard class="feed">
                <div>{{locationLabel}}</div>
                <div>{{selectedLocationOption.optionText}}</div>

                <p>
                @if (locationOutcomeDisplay.length > 0) {
                    @for (outcome of locationOutcomeDisplay; track outcome) {
                        <div>{{outcome}}</div>
                    }
                }
                </p>

                @if(
                    playerStory.storyId != "" 
                    && selectedLocationOption.successResults.length != 0
                    && loadStory
                ) {
                    <div>{{playerStory.prompt}}</div>

                    @if (outcomeDisplay.length > 0) {
                        @for (outcome of outcomeDisplay; track outcome) {
                            <div>{{outcome}}</div>
                        }
                    }
                }
            </div>
        </mat-card><br>
    }

    @if (locationOutcomeDisplay.length === 0) {
        <div class="option-buttons">
            <button mat-flat-button (click)="selectLocationOption(0)" style="margin-right: 10px;">{{ location.options[0].optionText }}</button>
            <button mat-flat-button (click)="selectLocationOption(1)">{{ location.options[1].optionText }}</button>
        </div>
    } @else  {
        @if (!loadStory) {
            <div class="option-buttons">
                <button mat-flat-button (click)="setLoadStory()">Continue</button>
            </div>
        } @else if (outcomeDisplay.length === 0) {
            <div class="option-buttons">
                <button mat-flat-button (click)="pickOption(0)">{{playerStory.options[0].optionText}}</button>
                <button mat-flat-button (click)="pickOption(1)">{{playerStory.options[1].optionText}}</button>
            </div>
        } @else {
            @if ((repercussionOutput.ending !== null || repercussionOutput.locationDestroyed !== null) && !repercussionsSubmitted) {
                <button mat-raised-button color="accent" (click)="openRepercussionsModal()">
                    You've learned something new!
                </button>
            } @else {
                <button mat-flat-button (click)="nextPlayerTurn()">
                    Continue
                </button>
            }
        }
    }
} @else {
    It's another player's turn right now! Hold your horses
}