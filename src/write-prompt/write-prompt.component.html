@if(currentStoryIndex >= playerStories.length) {
    <p>All stories have been submitted!</p>
} 
@else {
    <mat-chip-set><mat-chip class="progress">{{numberOfPromptsWritten}} / {{numberOfPromptsToWrite}} Prompts Written</mat-chip></mat-chip-set><br>

    <prequel-story-display
        [gameCode]="gameCode" 
        [story]="playerStories[currentStoryIndex]"
        [isAdventureMode]="false">
    </prequel-story-display>

    @if(playerStories[currentStoryIndex].mainPlotStory) {
        <div>This is a main plot story! It should involve an encounter with {{favorStat.favorEntity}}.</div><br>
    }
    
    @if (phase === WritePhase.PROMPT) {
        <div>Create a one to two sentence prompt for a story in the {{playerStories[currentStoryIndex].location.label}}</div><br>

        <mat-form-field class="full-width">
            <mat-label>Prompt</mat-label>
            <textarea [formControl]="prompt" matInput placeholder="Ex. You see a small child begging for scraps at the {{playerStories[currentStoryIndex].location.label}}"></textarea>
        </mat-form-field>
    }

    @if (phase === WritePhase.OPTIONS) {
        <mat-card class="story">{{prompt.value}}</mat-card><br>

        <div>
            Now give two options for how to manage the prompt. These are just options! Someone else will write the outcomes!
            To succeed in this story the player will need to have a lot of either:
        </div>
        <br>
        <section>
            <mat-chip-set><mat-chip class="stat">
            {{playerStories[currentStoryIndex].options[0].playerStatDCs[0].statType.label}}
            @if (playerStories[currentStoryIndex].options[0].playerStatDCs[0].statType.favorType) {
                with {{playerStories[currentStoryIndex].options[0].playerStatDCs[0].statType.favorEntity}}
            }
            [{{statDCDifficulty(0)}}]
            </mat-chip></mat-chip-set>
            <mat-form-field class="full-width">
                <mat-label>Option One</mat-label>
                <input matInput placeholder="Ex. Give the child some coin" id="optionOne" [formControl]="optionOne">
            </mat-form-field>
        </section>
        or
        <br>
        <section>
            <mat-chip-set><mat-chip class="stat">
                {{playerStories[currentStoryIndex].options[1].playerStatDCs[0].statType.label}} 
                @if (playerStories[currentStoryIndex].options[1].playerStatDCs[0].statType.favorType) {
                    with {{playerStories[currentStoryIndex].options[1].playerStatDCs[0].statType.favorEntity}}
                }
                [{{statDCDifficulty(1)}}]
            </mat-chip></mat-chip-set>
            <mat-form-field class="full-width">
                <mat-label>Option Two</mat-label>
                <input matInput placeholder="Ex. Beat the kid up"  id="optionTwo" [formControl]="optionTwo">
            </mat-form-field>
        </section>
    }
    <button mat-flat-button (click)="submitWriting()">Submit</button>
}